#! /usr/bin/env ruby
require 'dotenv'
require 'logger'
require_relative 'lib/setup'
require_relative 'lib/models/episode'

Dotenv.load
logger = Logger.new(STDOUT)

OUT_DIR = ENV.fetch('OUT_DIR')

file_number = ARGV[0].to_i
transcription_file_name = "#{OUT_DIR}/#{file_number}.txt"

File.open(transcription_file_name, 'r') do |file|
  transcription = file.read
  Episode.find_by(id: file_number).update!(transcription: transcription)
  logger.info("Transcription for episode #{file_number} saved")
end
